<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - Entremets & Saveurs</title>
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #c41e3a;
            --primary-dark: #8b0000;
            --secondary: #165b33;
            --gold: #d4af37;
            --bg-light: #f8f9fa;
            --text-dark: #2d3436;
            --text-light: #636e72;
            --white: #ffffff;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            --radius: 12px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-light); min-height: 100vh; }

        /* Login */
        .login-container {
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }
        .login-box {
            background: var(--white); padding: 3rem; border-radius: var(--radius);
            box-shadow: 0 20px 60px rgba(0,0,0,0.3); width: 100%; max-width: 400px; text-align: center;
        }
        .login-box h1 { font-family: 'Playfair Display', serif; color: var(--primary); margin-bottom: 0.5rem; }
        .login-box p { color: var(--text-light); margin-bottom: 2rem; }
        .form-group { margin-bottom: 1.5rem; text-align: left; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-dark); }
        .form-group input {
            width: 100%; padding: 0.8rem 1rem; border: 2px solid #e0e0e0;
            border-radius: 8px; font-size: 1rem; transition: all 0.3s;
        }
        .form-group input:focus { outline: none; border-color: var(--primary); }
        .btn {
            padding: 0.8rem 2rem; border: none; border-radius: 8px;
            font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s;
        }
        .btn-primary { background: var(--primary); color: var(--white); width: 100%; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); }
        .error-message {
            background: #ffe6e6; color: var(--primary); padding: 0.8rem;
            border-radius: 8px; margin-bottom: 1rem; display: none;
        }

        /* Admin Dashboard */
        .admin-container { display: none; }
        .admin-header {
            background: var(--white); padding: 1rem 2rem; box-shadow: var(--shadow);
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 100;
        }
        .admin-logo h1 { font-family: 'Playfair Display', serif; color: var(--primary); font-size: 1.5rem; }
        .admin-nav { display: flex; gap: 0.5rem; }
        .admin-nav a {
            color: var(--text-dark); text-decoration: none; padding: 0.5rem 1rem;
            border-radius: 8px; transition: all 0.3s;
        }
        .admin-nav a:hover, .admin-nav a.active { background: var(--primary); color: var(--white); }
        .btn-logout {
            background: var(--text-light); color: var(--white); padding: 0.5rem 1rem;
            border-radius: 8px; border: none; cursor: pointer; transition: all 0.3s;
        }
        .btn-logout:hover { background: var(--primary); }
        .admin-content { padding: 2rem; max-width: 1200px; margin: 0 auto; }
        .admin-section {
            background: var(--white); border-radius: var(--radius);
            padding: 2rem; margin-bottom: 2rem; box-shadow: var(--shadow);
        }
        .admin-section h2 {
            font-family: 'Playfair Display', serif; color: var(--text-dark);
            margin-bottom: 1.5rem; padding-bottom: 1rem;
            border-bottom: 2px solid var(--bg-light);
            display: flex; align-items: center; gap: 0.5rem;
        }
        .admin-section h2 i { color: var(--primary); }

        /* Toggle Switch */
        .toggle-container { display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem; }
        .toggle-switch { position: relative; width: 60px; height: 30px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider {
            position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc; transition: 0.4s; border-radius: 30px;
        }
        .toggle-slider:before {
            position: absolute; content: ""; height: 22px; width: 22px;
            left: 4px; bottom: 4px; background-color: white;
            transition: 0.4s; border-radius: 50%;
        }
        input:checked + .toggle-slider { background-color: var(--secondary); }
        input:checked + .toggle-slider:before { transform: translateX(30px); }

        /* Forms */
        .admin-form-group { margin-bottom: 1.5rem; }
        .admin-form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-dark); }
        .admin-form-group input, .admin-form-group textarea, .admin-form-group select {
            width: 100%; padding: 0.8rem 1rem; border: 2px solid #e0e0e0;
            border-radius: 8px; font-size: 1rem; font-family: inherit; transition: all 0.3s;
        }
        .admin-form-group textarea { min-height: 100px; resize: vertical; }
        .admin-form-group input:focus, .admin-form-group textarea:focus { outline: none; border-color: var(--primary); }
        .btn-save { background: var(--secondary); color: var(--white); }
        .btn-save:hover { background: #0d4025; }
        .btn-save:disabled { background: #ccc; cursor: not-allowed; }

        /* Grid */
        .admin-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
        .admin-card {
            background: var(--bg-light); border-radius: var(--radius);
            padding: 1.5rem; transition: all 0.3s;
        }
        .admin-card h3 { color: var(--text-dark); margin-bottom: 0.5rem; }
        .admin-card p { color: var(--text-light); font-size: 0.9rem; margin-bottom: 1rem; }

        /* Status */
        .status-badge {
            display: inline-flex; align-items: center; gap: 0.5rem;
            padding: 0.4rem 1rem; border-radius: 20px; font-size: 0.85rem;
        }
        .status-badge.online { background: #d4edda; color: #155724; }
        .status-badge.offline { background: #f8d7da; color: #721c24; }
        .status-badge.loading { background: #fff3cd; color: #856404; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; }
        .status-badge.online .status-dot { background: #28a745; }
        .status-badge.offline .status-dot { background: #dc3545; }
        .status-badge.loading .status-dot { background: #ffc107; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* Toast */
        .toast {
            position: fixed; bottom: 2rem; right: 2rem; padding: 1rem 2rem;
            border-radius: var(--radius); color: white; display: none;
            animation: slideIn 0.3s ease; z-index: 1000;
        }
        .toast.success { background: var(--secondary); }
        .toast.error { background: var(--primary); }
        .toast.show { display: flex; align-items: center; gap: 0.5rem; }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        /* Sections */
        .admin-section-page { display: none; }
        .admin-section-page.active { display: block; }

        /* Tabs */
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .tab-btn {
            padding: 0.6rem 1.2rem; border: none; background: var(--bg-light);
            cursor: pointer; border-radius: 8px; transition: all 0.3s; color: var(--text-dark);
        }
        .tab-btn:hover { background: #e0e0e0; }
        .tab-btn.active { background: var(--primary); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Responsive */
        @media (max-width: 768px) {
            .admin-header { flex-direction: column; gap: 1rem; }
            .admin-nav { flex-wrap: wrap; justify-content: center; }
            .admin-content { padding: 1rem; }
        }

        /* Firebase setup info */
        .setup-info {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);
            border: 2px solid #ffc107; border-radius: var(--radius);
            padding: 1.5rem; margin-bottom: 2rem;
        }
        .setup-info h3 { color: #856404; margin-bottom: 1rem; }
        .setup-info ol { margin-left: 1.5rem; color: #856404; }
        .setup-info li { margin-bottom: 0.5rem; }
        .setup-info code {
            background: rgba(0,0,0,0.1); padding: 0.2rem 0.5rem;
            border-radius: 4px; font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div class="login-container" id="loginPage">
        <div class="login-box">
            <h1>üéÑ Administration</h1>
            <p>Entremets & Saveurs</p>
            <div class="error-message" id="loginError">Identifiants incorrects</div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" placeholder="admin@entremets-saveurs.fr" required>
                </div>
                <div class="form-group">
                    <label for="password">Mot de passe</label>
                    <input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i> Connexion
                </button>
            </form>
            <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-light);">
                Premi√®re connexion ? <a href="#" onclick="createAccount()" style="color: var(--primary);">Cr√©er un compte admin</a>
            </p>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-container" id="adminDashboard">
        <header class="admin-header">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <h1 style="font-family: 'Playfair Display', serif; color: var(--primary);">üéÑ Admin</h1>
                <div class="status-badge loading" id="firebaseStatus">
                    <span class="status-dot"></span>
                    <span>Connexion...</span>
                </div>
            </div>
            <nav class="admin-nav">
                <a href="#" class="active" data-section="dashboard"><i class="fas fa-home"></i> Dashboard</a>
                <a href="#" data-section="contenu"><i class="fas fa-edit"></i> Contenu</a>
                <a href="#" data-section="parametres"><i class="fas fa-cog"></i> Param√®tres</a>
            </nav>
            <button class="btn-logout" onclick="logout()"><i class="fas fa-sign-out-alt"></i> D√©connexion</button>
        </header>

        <main class="admin-content">
            <!-- Setup Info (shown if Firebase not configured) -->
            <div class="setup-info" id="setupInfo" style="display: none;">
                <h3>‚ö†Ô∏è Configuration Firebase requise</h3>
                <ol>
                    <li>Va sur <a href="https://console.firebase.google.com/" target="_blank">Firebase Console</a></li>
                    <li>Cr√©e un nouveau projet</li>
                    <li>Active <strong>Realtime Database</strong> et <strong>Authentication</strong> (Email/Password)</li>
                    <li>Copie ta configuration dans <code>src/firebase-config.js</code></li>
                    <li>Rafra√Æchis cette page</li>
                </ol>
            </div>

            <!-- Dashboard -->
            <section id="dashboard" class="admin-section-page active">
                <div class="admin-section">
                    <h2><i class="fas fa-bolt"></i> Actions rapides</h2>
                    <div class="admin-grid">
                        <div class="admin-card">
                            <h3>üéÑ Mode No√´l</h3>
                            <p>Activer/d√©sactiver le th√®me festif</p>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="noelToggle" onchange="saveSetting('noelMode', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="noelStatus">-</span>
                            </div>
                        </div>
                        <div class="admin-card">
                            <h3>‚ùÑÔ∏è Neige</h3>
                            <p>Effet flocons de neige</p>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="snowToggle" onchange="saveSetting('snowMode', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="snowStatus">-</span>
                            </div>
                        </div>
                        <div class="admin-card">
                            <h3>üì¢ Bandeau</h3>
                            <p>Bandeau d'annonce en haut</p>
                            <div class="toggle-container">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="bannerToggle" onchange="saveSetting('bannerMode', this.checked)">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="bannerStatus">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h2><i class="fas fa-bullhorn"></i> Bandeau d'annonce</h2>
                    <div class="admin-form-group">
                        <label for="bannerText">Texte du bandeau</label>
                        <input type="text" id="bannerText" placeholder="Chargement...">
                    </div>
                    <div class="admin-form-group">
                        <label for="bannerLink">Image/Lien au clic (popup)</label>
                        <input type="text" id="bannerLink" placeholder="assets/images/buche tarif.jpg">
                    </div>
                    <button class="btn btn-save" onclick="saveBanner()">
                        <i class="fas fa-save"></i> Enregistrer
                    </button>
                </div>
            </section>

            <!-- Contenu -->
            <section id="contenu" class="admin-section-page">
                <div class="admin-section">
                    <h2><i class="fas fa-heading"></i> Modifier les textes</h2>
                    
                    <div class="tabs">
                        <button class="tab-btn active" onclick="showTab('heroTab', this)">Hero</button>
                        <button class="tab-btn" onclick="showTab('aboutTab', this)">√Ä propos</button>
                        <button class="tab-btn" onclick="showTab('contactTab', this)">Contact</button>
                    </div>

                    <div id="heroTab" class="tab-content active">
                        <div class="admin-form-group">
                            <label for="heroTitle">Titre</label>
                            <input type="text" id="heroTitle" placeholder="Entremets">
                        </div>
                        <div class="admin-form-group">
                            <label for="heroAccent">Titre color√©</label>
                            <input type="text" id="heroAccent" placeholder="& Saveurs">
                        </div>
                        <div class="admin-form-group">
                            <label for="heroSubtitle">Sous-titre</label>
                            <textarea id="heroSubtitle" placeholder="Description..."></textarea>
                        </div>
                        <button class="btn btn-save" onclick="saveHero()">
                            <i class="fas fa-save"></i> Enregistrer Hero
                        </button>
                    </div>

                    <div id="aboutTab" class="tab-content">
                        <div class="admin-form-group">
                            <label for="aboutTitle">Titre section</label>
                            <input type="text" id="aboutTitle" placeholder="Notre Histoire">
                        </div>
                        <div class="admin-form-group">
                            <label for="aboutText">Texte de pr√©sentation</label>
                            <textarea id="aboutText" rows="5" placeholder="Description..."></textarea>
                        </div>
                        <button class="btn btn-save" onclick="saveAbout()">
                            <i class="fas fa-save"></i> Enregistrer √Ä propos
                        </button>
                    </div>

                    <div id="contactTab" class="tab-content">
                        <div class="admin-form-group">
                            <label for="contactEmail">Email</label>
                            <input type="email" id="contactEmail" placeholder="contact@...">
                        </div>
                        <div class="admin-form-group">
                            <label for="contactPhone">T√©l√©phone</label>
                            <input type="tel" id="contactPhone" placeholder="06 ...">
                        </div>
                        <div class="admin-form-group">
                            <label for="contactAddress">Adresse</label>
                            <textarea id="contactAddress" placeholder="Adresse..."></textarea>
                        </div>
                        <button class="btn btn-save" onclick="saveContact()">
                            <i class="fas fa-save"></i> Enregistrer Contact
                        </button>
                    </div>
                </div>
            </section>

            <!-- Param√®tres -->
            <section id="parametres" class="admin-section-page">
                <div class="admin-section">
                    <h2><i class="fas fa-palette"></i> Couleurs</h2>
                    <div class="admin-grid">
                        <div class="admin-form-group">
                            <label for="colorPrimary">Couleur principale</label>
                            <input type="color" id="colorPrimary" value="#c41e3a" style="width:100%; height:50px; border:none; cursor:pointer;">
                        </div>
                        <div class="admin-form-group">
                            <label for="colorSecondary">Couleur secondaire</label>
                            <input type="color" id="colorSecondary" value="#165b33" style="width:100%; height:50px; border:none; cursor:pointer;">
                        </div>
                    </div>
                    <button class="btn btn-save" onclick="saveColors()">
                        <i class="fas fa-save"></i> Enregistrer couleurs
                    </button>
                </div>

                <div class="admin-section">
                    <h2><i class="fas fa-database"></i> Initialiser les donn√©es</h2>
                    <p style="margin-bottom: 1rem; color: var(--text-light);">
                        Premi√®re utilisation ? Clique pour cr√©er les donn√©es par d√©faut dans Firebase.
                    </p>
                    <button class="btn btn-save" onclick="initializeData()">
                        <i class="fas fa-magic"></i> Initialiser les donn√©es
                    </button>
                </div>
            </section>
        </main>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Message</span>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // üî• CONFIGURATION FIREBASE
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        const firebaseConfig = {
            apiKey: "AIzaSyCPTfARbFsZTdRxNA5CohEEDrLLs4Bcb5Y",
            authDomain: "entremets-et-saveurs.firebaseapp.com",
            databaseURL: "https://entremets-et-saveurs-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "entremets-et-saveurs",
            storageBucket: "entremets-et-saveurs.firebasestorage.app",
            messagingSenderId: "445743402926",
            appId: "1:445743402926:web:c57d0f7a9fecb3b115023f"
        };
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

        // Initialize Firebase
        let app, auth, database;
        let isFirebaseConfigured = false;

        try {
            if (firebaseConfig.apiKey && !firebaseConfig.apiKey.includes('XXXXX')) {
                app = firebase.initializeApp(firebaseConfig);
                auth = firebase.auth();
                database = firebase.database();
                isFirebaseConfigured = true;
            }
        } catch (error) {
            console.error('Firebase init error:', error);
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INITIALISATION
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        document.addEventListener('DOMContentLoaded', function() {
            setupNavigation();
            
            if (!isFirebaseConfigured) {
                document.getElementById('setupInfo').style.display = 'block';
                updateStatus('offline', 'Non configur√©');
                return;
            }

            // √âcouter l'√©tat d'authentification
            auth.onAuthStateChanged(user => {
                if (user) {
                    showDashboard();
                    loadAllData();
                    updateStatus('online', 'Connect√©');
                } else {
                    document.getElementById('loginPage').style.display = 'flex';
                    document.getElementById('adminDashboard').style.display = 'none';
                }
            });
        });

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // AUTHENTIFICATION
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                await auth.signInWithEmailAndPassword(email, password);
                showToast('Connexion r√©ussie !');
            } catch (error) {
                showError(getErrorMessage(error.code));
            }
        });

        async function createAccount() {
            const email = prompt('Email pour le compte admin:');
            const password = prompt('Mot de passe (min 6 caract√®res):');
            
            if (!email || !password) return;
            
            try {
                await auth.createUserWithEmailAndPassword(email, password);
                showToast('Compte cr√©√© avec succ√®s !');
            } catch (error) {
                alert('Erreur: ' + getErrorMessage(error.code));
            }
        }

        function logout() {
            auth.signOut();
            location.reload();
        }

        function getErrorMessage(code) {
            const messages = {
                'auth/invalid-email': 'Email invalide',
                'auth/user-not-found': 'Utilisateur non trouv√©',
                'auth/wrong-password': 'Mot de passe incorrect',
                'auth/email-already-in-use': 'Email d√©j√† utilis√©',
                'auth/weak-password': 'Mot de passe trop faible (min 6 caract√®res)'
            };
            return messages[code] || 'Erreur de connexion';
        }

        function showError(message) {
            const el = document.getElementById('loginError');
            el.textContent = message;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        function showDashboard() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminDashboard').style.display = 'block';
        }

        function updateStatus(status, text) {
            const el = document.getElementById('firebaseStatus');
            el.className = `status-badge ${status}`;
            el.innerHTML = `<span class="status-dot"></span><span>${text}</span>`;
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // NAVIGATION
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function setupNavigation() {
            document.querySelectorAll('.admin-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    document.querySelectorAll('.admin-nav a').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    const sectionId = this.getAttribute('data-section');
                    document.querySelectorAll('.admin-section-page').forEach(s => s.classList.remove('active'));
                    document.getElementById(sectionId).classList.add('active');
                });
            });
        }

        function showTab(tabId, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // CHARGER LES DONN√âES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function loadAllData() {
            // Settings
            database.ref('settings').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('noelToggle').checked = data.noelMode !== false;
                document.getElementById('snowToggle').checked = data.snowMode !== false;
                document.getElementById('bannerToggle').checked = data.bannerMode !== false;
                updateToggleLabels(data);
            });

            // Banner
            database.ref('banner').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('bannerText').value = data.text || '';
                document.getElementById('bannerLink').value = data.link || '';
            });

            // Hero
            database.ref('hero').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('heroTitle').value = data.title || '';
                document.getElementById('heroAccent').value = data.titleAccent || '';
                document.getElementById('heroSubtitle').value = data.subtitle || '';
            });

            // About
            database.ref('about').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('aboutTitle').value = data.title || '';
                document.getElementById('aboutText').value = data.text || '';
            });

            // Contact
            database.ref('contact').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('contactEmail').value = data.email || '';
                document.getElementById('contactPhone').value = data.phone || '';
                document.getElementById('contactAddress').value = data.address || '';
            });

            // Colors
            database.ref('colors').on('value', snapshot => {
                const data = snapshot.val() || {};
                document.getElementById('colorPrimary').value = data.primary || '#c41e3a';
                document.getElementById('colorSecondary').value = data.secondary || '#165b33';
            });
        }

        function updateToggleLabels(settings) {
            document.getElementById('noelStatus').textContent = settings.noelMode !== false ? 'Activ√©' : 'D√©sactiv√©';
            document.getElementById('snowStatus').textContent = settings.snowMode !== false ? 'Activ√©' : 'D√©sactiv√©';
            document.getElementById('bannerStatus').textContent = settings.bannerMode !== false ? 'Activ√©' : 'D√©sactiv√©';
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // SAUVEGARDER LES DONN√âES
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        async function saveSetting(key, value) {
            try {
                await database.ref(`settings/${key}`).set(value);
                showToast(`${key === 'noelMode' ? 'Mode No√´l' : key === 'snowMode' ? 'Neige' : 'Bandeau'} ${value ? 'activ√©' : 'd√©sactiv√©'}`);
            } catch (error) {
                showToast('Erreur de sauvegarde', 'error');
            }
        }

        async function saveBanner() {
            try {
                await database.ref('banner').update({
                    text: document.getElementById('bannerText').value,
                    link: document.getElementById('bannerLink').value
                });
                showToast('Bandeau mis √† jour !');
            } catch (error) {
                showToast('Erreur', 'error');
            }
        }

        async function saveHero() {
            try {
                await database.ref('hero').update({
                    title: document.getElementById('heroTitle').value,
                    titleAccent: document.getElementById('heroAccent').value,
                    subtitle: document.getElementById('heroSubtitle').value
                });
                showToast('Hero mis √† jour !');
            } catch (error) {
                showToast('Erreur', 'error');
            }
        }

        async function saveAbout() {
            try {
                await database.ref('about').update({
                    title: document.getElementById('aboutTitle').value,
                    text: document.getElementById('aboutText').value
                });
                showToast('√Ä propos mis √† jour !');
            } catch (error) {
                showToast('Erreur', 'error');
            }
        }

        async function saveContact() {
            try {
                await database.ref('contact').update({
                    email: document.getElementById('contactEmail').value,
                    phone: document.getElementById('contactPhone').value,
                    address: document.getElementById('contactAddress').value
                });
                showToast('Contact mis √† jour !');
            } catch (error) {
                showToast('Erreur', 'error');
            }
        }

        async function saveColors() {
            try {
                await database.ref('colors').update({
                    primary: document.getElementById('colorPrimary').value,
                    secondary: document.getElementById('colorSecondary').value
                });
                showToast('Couleurs mises √† jour !');
            } catch (error) {
                showToast('Erreur', 'error');
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // INITIALISER DONN√âES PAR D√âFAUT
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        async function initializeData() {
            if (!confirm('Ceci va cr√©er/√©craser les donn√©es par d√©faut. Continuer ?')) return;

            const defaultData = {
                settings: {
                    noelMode: true,
                    snowMode: true,
                    bannerMode: true
                },
                banner: {
                    text: "üéÑ B√õCHES DE NO√ãL ‚Äî R√©servez d√®s maintenant vos cr√©ations artisanales pour les f√™tes ! üéÑ",
                    link: "assets/images/buche tarif.jpg"
                },
                hero: {
                    title: "Entremets",
                    titleAccent: "& Saveurs",
                    subtitle: "L'art de la p√¢tisserie artisanale √† votre service"
                },
                about: {
                    title: "Notre Histoire",
                    text: "Passionn√©e par l'art de la p√¢tisserie depuis toujours, je cr√©e pour vous des desserts uniques et savoureux."
                },
                contact: {
                    email: "contact@entremets-saveurs.fr",
                    phone: "06 XX XX XX XX",
                    address: "Votre ville, France"
                },
                colors: {
                    primary: "#c41e3a",
                    secondary: "#165b33"
                }
            };

            try {
                await database.ref().set(defaultData);
                showToast('Donn√©es initialis√©es avec succ√®s !');
                loadAllData();
            } catch (error) {
                showToast('Erreur: ' + error.message, 'error');
            }
        }

        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        // TOAST
        // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
    </script>
</body>
</html>
