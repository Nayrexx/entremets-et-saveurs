<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ateliers Pâtisserie - Entremets et Saveurs</title>
    <meta name="description" content="Participez à nos ateliers pâtisserie : adultes, anniversaires enfants et team building. Réservez en ligne vos cours de pâtisserie.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    <link rel="stylesheet" href="src/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="src/mobile-detection.js"></script>

    <style>
        :root {
            --atelier-primary: #d4a574;
            --atelier-secondary: #8b5a3c;
            --atelier-accent: #c41e3a;
            --atelier-bg: #faf8f5;
            --atelier-card: #ffffff;
            --atelier-text: #3d3d3d;
            --atelier-text-light: #6b6b6b;
        }

        /* Hero Section */
        .ateliers-hero {
            background: linear-gradient(135deg, rgba(139, 90, 60, 0.9), rgba(196, 30, 58, 0.8)), 
                        url('assets/images/patisserie.jpg') center/cover;
            min-height: 50vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 140px 20px 80px;
            position: relative;
        }

        .ateliers-hero::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to top, var(--atelier-bg), transparent);
        }

        .ateliers-hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 5vw, 4rem);
            color: white;
            margin-bottom: 1rem;
            text-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .ateliers-hero p {
            font-size: 1.2rem;
            color: rgba(255,255,255,0.9);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Main Content */
        .ateliers-main {
            background: var(--atelier-bg);
            padding: 60px 0;
        }

        .ateliers-container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Section Titles */
        .section-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .section-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--atelier-secondary);
            margin-bottom: 1rem;
        }

        .section-header p {
            color: var(--atelier-text-light);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Ateliers Grid */
        .ateliers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 80px;
        }

        .atelier-card {
            background: var(--atelier-card);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            transition: all 0.4s ease;
            position: relative;
        }

        .atelier-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        .atelier-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--atelier-accent);
            color: white;
            padding: 8px 16px;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 600;
            z-index: 2;
        }

        .atelier-image {
            height: 220px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .atelier-image::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: linear-gradient(to top, var(--atelier-card), transparent);
        }

        .atelier-content {
            padding: 25px 30px 30px;
        }

        .atelier-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--atelier-primary), var(--atelier-secondary));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: -50px;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
            box-shadow: 0 8px 25px rgba(212, 165, 116, 0.4);
        }

        .atelier-icon i {
            font-size: 1.5rem;
            color: white;
        }

        .atelier-card h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            color: var(--atelier-text);
            margin-bottom: 12px;
        }

        .atelier-card > .atelier-content > p {
            color: var(--atelier-text-light);
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .atelier-details {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .atelier-detail {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--atelier-text);
        }

        .atelier-detail i {
            color: var(--atelier-primary);
            width: 18px;
        }

        .atelier-price-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .atelier-price {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--atelier-accent);
            font-weight: 600;
        }

        .atelier-price span {
            font-size: 1rem;
            color: var(--atelier-text-light);
            font-family: 'Inter', sans-serif;
            font-weight: 400;
        }

        .btn-reserver {
            background: linear-gradient(135deg, var(--atelier-accent), #a01830);
            color: white;
            padding: 12px 28px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-reserver:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(196, 30, 58, 0.4);
        }

        /* Section Réservation */
        .reservation-section {
            background: white;
            border-radius: 30px;
            padding: 50px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            margin-bottom: 60px;
        }

        .reservation-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .reservation-header h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--atelier-secondary);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .reservation-header h2 i {
            color: var(--atelier-accent);
        }

        .reservation-note {
            background: #f0fdf4;
            border-left: 4px solid #22c55e;
            padding: 12px 20px;
            border-radius: 0 10px 10px 0;
            color: #166534;
            font-size: 0.95rem;
        }

        .reservation-note i {
            margin-right: 8px;
        }

        .simplybook-container {
            border-radius: 20px;
            overflow: hidden;
            min-height: 650px;
            background: #f8f8f8;
        }

        /* Contact rapide */
        .contact-rapide {
            background: linear-gradient(135deg, var(--atelier-secondary), var(--atelier-accent));
            border-radius: 20px;
            padding: 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            color: white;
        }

        .contact-item {
            text-align: center;
        }

        .contact-item i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .contact-item h4 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .contact-item a, .contact-item p {
            color: rgba(255,255,255,0.9);
            text-decoration: none;
            font-size: 1rem;
        }

        .contact-item a:hover {
            color: white;
            text-decoration: underline;
        }

        /* Info boxes */
        .info-boxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 60px;
        }

        .info-box {
            background: white;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            transition: all 0.3s;
        }

        .info-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
        }

        .info-box i {
            font-size: 2.5rem;
            color: var(--atelier-primary);
            margin-bottom: 15px;
        }

        .info-box h4 {
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            color: var(--atelier-text);
            margin-bottom: 10px;
        }

        .info-box p {
            color: var(--atelier-text-light);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .ateliers-hero {
                min-height: 40vh;
                padding: 120px 15px 60px;
            }

            .ateliers-grid {
                grid-template-columns: 1fr;
            }

            .reservation-section {
                padding: 30px 20px;
                border-radius: 20px;
            }

            .reservation-header {
                flex-direction: column;
                text-align: center;
            }

            .contact-rapide {
                padding: 30px 20px;
            }
        }

        /* Formulaire de réservation */
        .reservation-form {
            max-width: 800px;
            margin: 0 auto;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--atelier-text);
            font-size: 0.95rem;
        }

        .form-group label i {
            color: var(--atelier-primary);
            margin-right: 8px;
            width: 18px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e5e5e5;
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s;
            background: #fafafa;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--atelier-accent);
            background: white;
            box-shadow: 0 0 0 4px rgba(196, 30, 58, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-separator {
            text-align: center;
            margin: 30px 0;
            position: relative;
        }

        .form-separator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e5e5e5;
        }

        .form-separator span {
            background: white;
            padding: 0 20px;
            position: relative;
            color: var(--atelier-secondary);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .form-price-summary {
            background: linear-gradient(135deg, #fef9f3, #fff5eb);
            border: 2px solid var(--atelier-primary);
            border-radius: 16px;
            padding: 20px 25px;
            margin: 25px 0;
        }

        .price-line {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: var(--atelier-text);
        }

        .price-line.total {
            border-top: 2px solid var(--atelier-primary);
            margin-top: 10px;
            padding-top: 15px;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--atelier-accent);
        }

        .btn-submit-reservation {
            width: 100%;
            padding: 18px 30px;
            background: linear-gradient(135deg, var(--atelier-accent), #a01830);
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-submit-reservation:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(196, 30, 58, 0.4);
        }

        .form-note {
            text-align: center;
            color: var(--atelier-text-light);
            font-size: 0.9rem;
            margin-top: 20px;
        }

        .form-note i {
            color: var(--atelier-primary);
            margin-right: 5px;
        }

        /* Confirmation */
        .confirmation-message {
            text-align: center;
            padding: 50px 30px;
        }

        .confirmation-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 25px;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .confirmation-icon i {
            font-size: 3rem;
            color: white;
        }

        .confirmation-message h3 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--atelier-text);
            margin-bottom: 15px;
        }

        .confirmation-message p {
            color: var(--atelier-text-light);
            font-size: 1.1rem;
            max-width: 500px;
            margin: 0 auto 30px;
            line-height: 1.7;
        }

        .btn-new-reservation {
            background: var(--atelier-secondary);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-new-reservation:hover {
            background: var(--atelier-accent);
        }
    </style>
</head>
<body class="noel">
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html">
                    <img src="assets/images/logo.jpg" alt="Entremets et Saveurs - Logo" class="logo-image">
                </a>
            </div>
            
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">Accueil</a></li>
                <li class="nav-item"><a href="index.html#about" class="nav-link">À Propos</a></li>
                <li class="nav-item"><a href="index.html#gallery" class="nav-link">Galerie</a></li>
                <li class="nav-item"><a href="boutique.html" class="nav-link">Boutique</a></li>
                <li class="nav-item"><a href="formules.html" class="nav-link">Formules</a></li>
                <li class="nav-item"><a href="ateliers.html" class="nav-link active">Ateliers</a></li>
                <li class="nav-item"><a href="index.html#contact" class="nav-link">Contact</a></li>
                <li class="nav-item cta">
                    <a href="tel:+33644177920" class="nav-link btn-call">
                        <i class="fas fa-phone"></i> <span>Appeler</span>
                    </a>
                </li>
            </ul>
            
            <div class="hamburger" id="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <section class="ateliers-hero">
        <div>
            <h1 data-aos="fade-up">Nos Ateliers Pâtisserie</h1>
            <p data-aos="fade-up" data-aos-delay="100">Apprenez les secrets de la pâtisserie française dans une ambiance conviviale et créative</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="ateliers-main">
        <div class="ateliers-container">

            <!-- Info boxes -->
            <div class="info-boxes" data-aos="fade-up">
                <div class="info-box">
                    <i class="fas fa-users"></i>
                    <h4>Petits groupes</h4>
                    <p>Maximum 8 participants pour un accompagnement personnalisé</p>
                </div>
                <div class="info-box">
                    <i class="fas fa-cookie-bite"></i>
                    <h4>Repartez avec vos créations</h4>
                    <p>Emportez vos réalisations pour les déguster en famille</p>
                </div>
                <div class="info-box">
                    <i class="fas fa-certificate"></i>
                    <h4>Tous niveaux</h4>
                    <p>Nos ateliers s'adaptent à votre niveau, débutant ou confirmé</p>
                </div>
            </div>

            <!-- Ateliers Cards -->
            <div class="section-header" data-aos="fade-up">
                <h2>Choisissez votre atelier</h2>
                <p>Des expériences gourmandes pour tous les âges et toutes les occasions</p>
            </div>

            <div class="ateliers-grid" id="ateliersGrid">
                <!-- Les ateliers seront chargés dynamiquement depuis Firebase -->
                <div class="loading-ateliers" style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #666;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 15px; display: block;"></i>
                    Chargement des ateliers...
                </div>
            </div>

            <!-- Section Réservation -->
            <section class="reservation-section" id="reservation" data-aos="fade-up">
                <div class="reservation-header">
                    <h2><i class="fas fa-calendar-alt"></i> Réservez votre atelier</h2>
                    <div class="reservation-note">
                        <i class="fas fa-info-circle"></i>
                        Annulation gratuite jusqu'à 48h avant l'atelier
                    </div>
                </div>
                
                <!-- Formulaire de réservation -->
                <form id="reservationForm" class="reservation-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-birthday-cake"></i> Type d'atelier *</label>
                            <select id="atelierType" required>
                                <option value="">Choisissez un atelier</option>
                                <!-- Options chargées dynamiquement -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-users"></i> Nombre de participants *</label>
                            <select id="participants" required>
                                <option value="">Nombre de personnes</option>
                                <!-- Options ajustées selon l'atelier sélectionné -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Date souhaitée *</label>
                            <input type="date" id="dateAtelier" required min="">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-clock"></i> Créneau horaire *</label>
                            <select id="creneau" required>
                                <option value="">Choisissez un créneau</option>
                                <option value="09:00">9h00 - 12h00 (Matin)</option>
                                <option value="14:00">14h00 - 17h00 (Après-midi)</option>
                                <option value="autre">Autre (préciser dans le message)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-separator">
                        <span>Vos coordonnées</span>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> Nom complet *</label>
                            <input type="text" id="nomClient" placeholder="Votre nom et prénom" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-phone"></i> Téléphone *</label>
                            <input type="tel" id="telClient" placeholder="06 XX XX XX XX" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-envelope"></i> Email *</label>
                        <input type="email" id="emailClient" placeholder="votre@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-comment"></i> Message / Demandes particulières</label>
                        <textarea id="messageClient" rows="4" placeholder="Allergies, occasion spéciale, questions..."></textarea>
                    </div>
                    
                    <div class="form-price-summary" id="priceSummary" style="display: none;">
                        <div class="price-line">
                            <span>Atelier sélectionné :</span>
                            <span id="summaryAtelier">-</span>
                        </div>
                        <div class="price-line">
                            <span>Participants :</span>
                            <span id="summaryParticipants">-</span>
                        </div>
                        <div class="price-line total">
                            <span>Estimation :</span>
                            <span id="summaryTotal">-</span>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-submit-reservation">
                        <i class="fas fa-paper-plane"></i> Envoyer ma demande de réservation
                    </button>
                    
                    <p class="form-note">
                        <i class="fas fa-info-circle"></i>
                        Nous vous recontacterons sous 24h pour confirmer votre réservation
                    </p>
                </form>
                
                <!-- Message de confirmation -->
                <div id="confirmationMessage" class="confirmation-message" style="display: none;">
                    <div class="confirmation-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Demande envoyée avec succès !</h3>
                    <p>Merci pour votre demande de réservation. Nous vous contacterons très rapidement pour confirmer votre atelier.</p>
                    <button onclick="resetForm()" class="btn-new-reservation">
                        <i class="fas fa-plus"></i> Nouvelle réservation
                    </button>
                </div>
            </section>

            <!-- Contact rapide -->
            <div class="contact-rapide" data-aos="fade-up">
                <div class="contact-item">
                    <i class="fas fa-phone-alt"></i>
                    <h4>Par téléphone</h4>
                    <a href="tel:+33644177920">06 44 17 79 20</a>
                </div>
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <h4>Par email</h4>
                    <a href="mailto:entremets-et-saveurs@orange.fr">entremets-et-saveurs@orange.fr</a>
                </div>
                <div class="contact-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h4>Notre adresse</h4>
                    <p>Hameau de Rebelle, 11240 Montgradail</p>
                </div>
            </div>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <div class="footer-logo">
                        <img src="assets/images/logo.jpg" alt="Entremets et Saveurs" class="footer-logo-image">
                    </div>
                    <p>L'art de la pâtisserie revisité avec passion et créativité.</p>
                    <div class="footer-social">
                        <a href="https://www.facebook.com/entremetsetsaveurs/" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.instagram.com/entremetsetsaveurs/" target="_blank"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                
                <div class="footer-links">
                    <h4>Navigation</h4>
                    <ul>
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="boutique.html">Boutique</a></li>
                        <li><a href="formules.html">Formules</a></li>
                        <li><a href="ateliers.html">Ateliers</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact">
                    <h4>Contact</h4>
                    <div class="footer-contact-item">
                        <i class="fas fa-phone"></i>
                        <a href="tel:+33644177920">06 44 17 79 20</a>
                    </div>
                    <div class="footer-contact-item">
                        <i class="fas fa-envelope"></i>
                        <a href="mailto:entremets-et-saveurs@orange.fr">entremets-et-saveurs@orange.fr</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Entremets et Saveurs. Tous droits réservés.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase (doit être chargé en premier) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // Configuration Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCPTfARbFsZTdRxNA5CohEEDrLLs4Bcb5Y",
            authDomain: "entremets-et-saveurs.firebaseapp.com",
            databaseURL: "https://entremets-et-saveurs-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "entremets-et-saveurs",
            storageBucket: "entremets-et-saveurs.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abcdef123456"
        };
        
        // Initialize Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const db = firebase.database();
    </script>

    <!-- Scripts -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init({ duration: 800, once: true });

        // Mobile menu
        const hamburger = document.getElementById('hamburger');
        const navMenu = document.getElementById('nav-menu');
        hamburger?.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Navbar scroll
        window.addEventListener('scroll', () => {
            const navbar = document.getElementById('navbar');
            navbar.classList.toggle('scrolled', window.scrollY > 100);
        });

        // Smooth scroll to reservation
        document.querySelectorAll('a[href="#reservation"]').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                document.getElementById('reservation').scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });

        // Set minimum date to today
        const dateInput = document.getElementById('dateAtelier');
        const today = new Date();
        today.setDate(today.getDate() + 2); // Réservation minimum 2 jours à l'avance
        dateInput.min = today.toISOString().split('T')[0];

        // =====================
        // CHARGEMENT DES ATELIERS
        // =====================
        
        let ateliersData = {};

        // Charger les ateliers depuis Firebase
        function loadAteliers() {
            db.ref('ateliers').on('value', (snapshot) => {
                ateliersData = snapshot.val() || {};
                renderAteliersCards();
                updateAtelierSelect();
            });
        }

        // Afficher les cartes d'ateliers
        function renderAteliersCards() {
            const grid = document.getElementById('ateliersGrid');
            grid.innerHTML = '';

            const activeAteliers = Object.entries(ateliersData)
                .filter(([id, atelier]) => atelier.statut === 'actif')
                .sort((a, b) => a[1].nom.localeCompare(b[1].nom));

            if (activeAteliers.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #666;">
                        <i class="fas fa-calendar-times" style="font-size: 3rem; margin-bottom: 15px; display: block; opacity: 0.5;"></i>
                        <h3 style="margin-bottom: 10px;">Aucun atelier disponible</h3>
                        <p>Les ateliers seront bientôt disponibles. Contactez-nous pour plus d'informations.</p>
                        <a href="tel:+33644177920" style="display: inline-block; margin-top: 20px; padding: 12px 25px; background: var(--atelier-primary); color: white; text-decoration: none; border-radius: 10px;">
                            <i class="fas fa-phone"></i> Nous appeler
                        </a>
                    </div>
                `;
                return;
            }

            activeAteliers.forEach(([id, atelier], index) => {
                const card = document.createElement('div');
                card.className = 'atelier-card';
                card.setAttribute('data-aos', 'fade-up');
                card.setAttribute('data-aos-delay', (index * 100).toString());

                // Déterminer le prix à afficher
                let prixDisplay = '';
                let prixSuffix = '';
                if (atelier.tarifType === 'devis') {
                    prixDisplay = 'Sur devis';
                    prixSuffix = '';
                } else if (atelier.tarifType === 'groupe') {
                    prixDisplay = atelier.prix + '€';
                    prixSuffix = '/ groupe';
                } else {
                    prixDisplay = atelier.prix + '€';
                    prixSuffix = '/ pers.';
                }

                // Image par défaut si non définie
                const imageUrl = atelier.image || 'assets/images/patisserie2.jpg';

                // Bouton selon le type de tarif
                let actionButton = '';
                if (atelier.tarifType === 'devis') {
                    actionButton = `<a href="tel:+33644177920" class="btn-reserver"><i class="fas fa-phone"></i> Nous appeler</a>`;
                } else {
                    actionButton = `<a href="#reservation" class="btn-reserver" onclick="selectAtelier('${id}')"><i class="fas fa-calendar-check"></i> Réserver</a>`;
                }

                card.innerHTML = `
                    <div class="atelier-image" style="background-image: url('${imageUrl}')"></div>
                    <div class="atelier-content">
                        <div class="atelier-icon">
                            <i class="fas fa-birthday-cake"></i>
                        </div>
                        <h3>${atelier.nom}</h3>
                        <p>${atelier.description || 'Découvrez cet atelier unique et gourmand.'}</p>
                        <div class="atelier-details">
                            <div class="atelier-detail"><i class="fas fa-clock"></i> ${atelier.duree || '3h'}</div>
                            <div class="atelier-detail"><i class="fas fa-user-friends"></i> ${atelier.participants || `${atelier.minPers || 1}-${atelier.maxPers || 8} pers.`}</div>
                            <div class="atelier-detail"><i class="fas fa-utensils"></i> Matériel fourni</div>
                        </div>
                        <div class="atelier-price-row">
                            <div class="atelier-price">${prixDisplay} ${prixSuffix ? `<span>${prixSuffix}</span>` : ''}</div>
                            ${actionButton}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });

            // Réinitialiser AOS pour les nouvelles cartes
            if (typeof AOS !== 'undefined') {
                AOS.refresh();
            }
        }

        // Mettre à jour le select du formulaire
        function updateAtelierSelect() {
            const select = document.getElementById('atelierType');
            select.innerHTML = '<option value="">Choisissez un atelier</option>';

            const activeAteliers = Object.entries(ateliersData)
                .filter(([id, atelier]) => atelier.statut === 'actif' && atelier.tarifType !== 'devis')
                .sort((a, b) => a[1].nom.localeCompare(b[1].nom));

            activeAteliers.forEach(([id, atelier]) => {
                let prixInfo = '';
                if (atelier.tarifType === 'groupe') {
                    prixInfo = ` - ${atelier.prix}€/groupe`;
                } else {
                    prixInfo = ` - ${atelier.prix}€/pers.`;
                }

                const option = document.createElement('option');
                option.value = id;
                option.textContent = atelier.nom + prixInfo;
                option.dataset.prix = atelier.prix;
                option.dataset.tarifType = atelier.tarifType;
                option.dataset.minPers = atelier.minPers || 1;
                option.dataset.maxPers = atelier.maxPers || 8;
                select.appendChild(option);
            });
        }

        // Sélectionner un atelier depuis la carte
        function selectAtelier(id) {
            const select = document.getElementById('atelierType');
            select.value = id;
            updateParticipantsOptions();
            updatePriceSummary();
        }

        // Mettre à jour les options de participants selon l'atelier
        function updateParticipantsOptions() {
            const select = document.getElementById('atelierType');
            const participantsSelect = document.getElementById('participants');
            const selectedOption = select.options[select.selectedIndex];

            participantsSelect.innerHTML = '<option value="">Nombre de personnes</option>';

            if (!selectedOption || !selectedOption.value) return;

            const minPers = parseInt(selectedOption.dataset.minPers) || 1;
            const maxPers = parseInt(selectedOption.dataset.maxPers) || 8;

            for (let i = minPers; i <= maxPers; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i + (i > 1 ? ' personnes' : ' personne');
                participantsSelect.appendChild(option);
            }

            // Option pour plus de participants
            const optionPlus = document.createElement('option');
            optionPlus.value = 'plus';
            optionPlus.textContent = `Plus de ${maxPers} (nous contacter)`;
            participantsSelect.appendChild(optionPlus);
        }

        document.getElementById('atelierType').addEventListener('change', () => {
            updateParticipantsOptions();
            updatePriceSummary();
        });

        // Mise à jour du résumé de prix
        function updatePriceSummary() {
            const select = document.getElementById('atelierType');
            const participants = document.getElementById('participants').value;
            const summary = document.getElementById('priceSummary');
            const selectedOption = select.options[select.selectedIndex];

            if (!selectedOption || !selectedOption.value || !participants) {
                summary.style.display = 'none';
                return;
            }

            summary.style.display = 'block';
            const atelier = ateliersData[selectedOption.value];
            
            if (!atelier) return;

            document.getElementById('summaryAtelier').textContent = atelier.nom;
            document.getElementById('summaryParticipants').textContent = participants === 'plus' ? 'Plus de ' + atelier.maxPers : participants + (parseInt(participants) > 1 ? ' personnes' : ' personne');

            let total = '-';
            if (participants === 'plus') {
                total = 'Sur devis';
            } else if (atelier.tarifType === 'groupe') {
                total = atelier.prix + '€ (forfait groupe)';
            } else {
                total = (parseInt(participants) * atelier.prix) + '€';
            }

            document.getElementById('summaryTotal').textContent = total;
        }

        document.getElementById('participants').addEventListener('change', updatePriceSummary);

        // Soumission du formulaire
        document.getElementById('reservationForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const atelierSelect = document.getElementById('atelierType');
            const atelierId = atelierSelect.value;
            const atelier = ateliersData[atelierId];

            const formData = {
                type: atelierId,
                typeNom: atelier ? atelier.nom : 'Inconnu',
                participants: document.getElementById('participants').value,
                date: document.getElementById('dateAtelier').value,
                creneau: document.getElementById('creneau').value,
                nom: document.getElementById('nomClient').value,
                telephone: document.getElementById('telClient').value,
                email: document.getElementById('emailClient').value,
                message: document.getElementById('messageClient').value,
                dateCreation: new Date().toISOString(),
                statut: 'en-attente'
            };

            // Calcul du prix estimé
            if (atelier) {
                const nbPers = parseInt(formData.participants) || 0;
                if (formData.participants === 'plus') {
                    formData.prixEstime = 'Sur devis';
                } else if (atelier.tarifType === 'groupe') {
                    formData.prixEstime = atelier.prix;
                } else {
                    formData.prixEstime = nbPers * atelier.prix;
                }
            } else {
                formData.prixEstime = 'Sur devis';
            }

            const btn = e.target.querySelector('button[type="submit"]');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Envoi en cours...';
            btn.disabled = true;

            try {
                // Enregistrement dans Firebase
                if (typeof firebase !== 'undefined' && firebase.database) {
                    const db = firebase.database();
                    await db.ref('reservations-ateliers').push(formData);
                    
                    // Afficher confirmation
                    document.getElementById('reservationForm').style.display = 'none';
                    document.getElementById('confirmationMessage').style.display = 'block';
                } else {
                    // Fallback si Firebase n'est pas dispo : mailto
                    const subject = encodeURIComponent(`Réservation Atelier - ${formData.nom}`);
                    const body = encodeURIComponent(
                        `Nouvelle demande de réservation d'atelier\n\n` +
                        `Type: ${formData.type}\n` +
                        `Participants: ${formData.participants}\n` +
                        `Date souhaitée: ${formData.date}\n` +
                        `Créneau: ${formData.creneau}\n\n` +
                        `Nom: ${formData.nom}\n` +
                        `Téléphone: ${formData.telephone}\n` +
                        `Email: ${formData.email}\n\n` +
                        `Message: ${formData.message || 'Aucun'}\n\n` +
                        `Prix estimé: ${formData.prixEstime}€`
                    );
                    window.location.href = `mailto:entremets-et-saveurs@orange.fr?subject=${subject}&body=${body}`;
                    
                    document.getElementById('reservationForm').style.display = 'none';
                    document.getElementById('confirmationMessage').style.display = 'block';
                }
            } catch (error) {
                console.error('Erreur:', error);
                alert('Une erreur est survenue. Veuillez nous contacter par téléphone.');
            }

            btn.innerHTML = '<i class="fas fa-paper-plane"></i> Envoyer ma demande de réservation';
            btn.disabled = false;
        });

        // Reset du formulaire
        function resetForm() {
            document.getElementById('reservationForm').reset();
            document.getElementById('reservationForm').style.display = 'block';
            document.getElementById('confirmationMessage').style.display = 'none';
            document.getElementById('priceSummary').style.display = 'none';
            document.getElementById('participants').innerHTML = '<option value="">Nombre de personnes</option>';
        }

        // Charger les ateliers au démarrage
        loadAteliers();
    </script>
    
    <script src="src/script.js"></script>
</body>
</html>
